{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"navbar\"\n}, [/*#__PURE__*/_createElementVNode(\"img\", {\n  src: \"back.png\",\n  width: \"30px\"\n})], -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"mainContent\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"Uzupełnij swój profil\", -1 /* HOISTED */);\nconst _hoisted_5 = {\n  class: \"form-control\",\n  type: \"text\",\n  ref: \"nickname\",\n  placeholder: \"Nick\",\n  required: \"\"\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"span\", {\n  id: \"nickname-error\",\n  class: \"error-msg\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_7 = {\n  class: \"form-control\",\n  ref: \"yourCountry\"\n};\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"option\", {\n  value: \"\",\n  selected: \"\",\n  disabled: \"\",\n  hidden: \"\"\n}, \"Kraj pochodzenia\", -1 /* HOISTED */);\nconst _hoisted_9 = [\"value\"];\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"option\", {\n  value: \"\",\n  selected: \"\",\n  disabled: \"\",\n  hidden: \"\"\n}, \"Kraj kontaktowy\", -1 /* HOISTED */);\nconst _hoisted_11 = [\"value\"];\nconst _hoisted_12 = {\n  class: \"form-control\",\n  ref: \"language\"\n};\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"option\", {\n  value: \"\",\n  selected: \"\",\n  disabled: \"\",\n  hidden: \"\"\n}, \"Język\", -1 /* HOISTED */);\nconst _hoisted_14 = [\"value\"];\nconst _hoisted_15 = {\n  class: \"form-control\",\n  type: \"date\",\n  ref: \"birthdate\",\n  required: \"\"\n};\nconst _hoisted_16 = {\n  class: \"form-control\",\n  ref: \"selectedHobbies\"\n};\nconst _hoisted_17 = /*#__PURE__*/_createElementVNode(\"option\", {\n  value: \"\",\n  selected: \"\",\n  disabled: \"\",\n  hidden: \"\"\n}, \"Zainteresowania\", -1 /* HOISTED */);\nconst _hoisted_18 = [\"value\"];\nconst _hoisted_19 = {\n  class: \"form-control\",\n  ref: \"moreInfo\",\n  placeholder: \"Więcej informacji\"\n};\nconst _hoisted_20 = /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"btn btn-primary\",\n  type: \"submit\"\n}, \"Uzupełnij\", -1 /* HOISTED */);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.completeProfile, [\"prevent\"])\n  }, [_createElementVNode(\"input\", _hoisted_5, null, 512 /* NEED_PATCH */), _hoisted_6, _createElementVNode(\"select\", _hoisted_7, [_hoisted_8, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.countries, (yourCountry, index) => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: index,\n      value: yourCountry.name\n    }, _toDisplayString(yourCountry.name), 9 /* TEXT, PROPS */, _hoisted_9);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), _createElementVNode(\"select\", {\n    class: \"form-control\",\n    ref: \"contactCountry\",\n    onChange: $setup.contactCountryChanged\n  }, [_hoisted_10, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.countries, (contactCountry, index) => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: index,\n      value: contactCountry.name\n    }, _toDisplayString(contactCountry.name), 9 /* TEXT, PROPS */, _hoisted_11);\n  }), 128 /* KEYED_FRAGMENT */))], 544 /* NEED_HYDRATION, NEED_PATCH */), _createElementVNode(\"select\", _hoisted_12, [_hoisted_13, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.selectedContactCountryLanguages, (language, index) => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: index,\n      value: language\n    }, _toDisplayString(language), 9 /* TEXT, PROPS */, _hoisted_14);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), _createElementVNode(\"input\", _hoisted_15, null, 512 /* NEED_PATCH */), _createElementVNode(\"select\", _hoisted_16, [_hoisted_17, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.hobbies, (hobby, index) => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: index,\n      value: hobby\n    }, _toDisplayString(hobby), 9 /* TEXT, PROPS */, _hoisted_18);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), _createElementVNode(\"textarea\", _hoisted_19, null, 512 /* NEED_PATCH */), _hoisted_20], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","_createElementVNode","src","width","type","ref","placeholder","required","id","value","selected","disabled","hidden","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","onSubmit","_withModifiers","$setup","completeProfile","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","countries","yourCountry","index","key","name","_hoisted_9","onChange","contactCountryChanged","_hoisted_10","contactCountry","_hoisted_11","_hoisted_12","_hoisted_13","selectedContactCountryLanguages","language","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","hobbies","hobby","_hoisted_18","_hoisted_19","_hoisted_20"],"sources":["D:\\UserData\\Desktop\\UEK\\PSM\\KKDP\\psm-project\\src\\components\\CompleteProfilePage.vue"],"sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <div class=\"navbar\"><img src=\"back.png\" width=\"30px\"/></div>\r\n        <div class=\"mainContent\">\r\n            <h2>Uzupełnij swój profil</h2>\r\n            <form @submit.prevent=\"completeProfile\">\r\n                <input class=\"form-control\" type=\"text\" ref=\"nickname\" placeholder=\"Nick\" required>\r\n                <span id=\"nickname-error\" class=\"error-msg\"></span>\r\n                <select class=\"form-control\" ref=\"yourCountry\">\r\n                    <option value=\"\" selected disabled hidden>Kraj pochodzenia</option>\r\n                    <option v-for=\"(yourCountry, index) in countries\" :key=\"index\" :value=\"yourCountry.name\">{{ yourCountry.name }}</option>\r\n                </select>\r\n                <select class=\"form-control\" ref=\"contactCountry\" @change=\"contactCountryChanged\">\r\n                    <option value=\"\" selected disabled hidden>Kraj kontaktowy</option>\r\n                    <option v-for=\"(contactCountry, index) in countries\" :key=\"index\" :value=\"contactCountry.name\">{{ contactCountry.name }}</option>\r\n                </select>\r\n                <select class=\"form-control\" ref=\"language\">\r\n                    <option value=\"\" selected disabled hidden>Język</option>\r\n                    <option v-for=\"(language, index) in selectedContactCountryLanguages\" :key=\"index\" :value=\"language\">{{ language }}</option>\r\n                </select>\r\n                <input class=\"form-control\" type=\"date\" ref=\"birthdate\" required>\r\n                <select class=\"form-control\" ref=\"selectedHobbies\">\r\n                    <option value=\"\" selected disabled hidden>Zainteresowania</option>\r\n                    <option v-for=\"(hobby, index) in hobbies\" :key=\"index\" :value=\"hobby\">{{ hobby }}</option>\r\n                </select>\r\n                <textarea class=\"form-control\" ref=\"moreInfo\" placeholder=\"Więcej informacji\"></textarea>\r\n                <button class=\"btn btn-primary\" type=\"submit\">Uzupełnij</button>\r\n            </form>\r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<style>\r\n\r\n\r\n</style>\r\n\r\n<script setup>\r\n    import { firebaseApp } from '@/firebase';\r\n    import { doc, setDoc, getFirestore, collection, getDocs } from 'firebase/firestore';\r\n    import { ref, onMounted } from 'vue';\r\n    import { useAuthStore } from '@/stores/auth';\r\n    import { useRouter } from 'vue-router';\r\n\r\n    const nickname = ref('');\r\n    const yourCountry = ref('');\r\n    const contactCountry = ref('');\r\n    const language = ref('');\r\n    const birthdate = ref('');\r\n    const selectedHobbies = ref('');\r\n    const moreInfo = ref('');\r\n    let countries = ref([]);\r\n    let hobbies = ref([]);\r\n    let selectedContactCountryLanguages = ref([]);\r\n\r\n    const router = useRouter();\r\n    const authStore = useAuthStore();\r\n\r\n    onMounted(() => {\r\n        const db = getFirestore(firebaseApp);\r\n        const langColRef = collection(db, \"languages\");\r\n        getDocs(langColRef)\r\n        .then((result) => {\r\n            result.forEach((doc) => {\r\n                countries.value.push({'name': doc.id, ...doc.data()});\r\n            })\r\n            if(authStore.user.contactCountry) contactCountry.value.value = countries.value.find(country => country.name === authStore.user.contactCountry);\r\n            if(authStore.user.country) yourCountry.value.value = countries.value.find(country => country.name === authStore.user.country);\r\n            // if(authStore.user.language) language.value.value = language.value.find(authStore.user.language);\r\n        });\r\n\r\n        const hobbiesColRef = collection(db, \"hobbies\");\r\n\r\n        getDocs(hobbiesColRef)\r\n        .then((result) => {\r\n            result.forEach((doc) => {\r\n                hobbies.value.push(doc.id);\r\n            })\r\n            if(authStore.user.moreInfo) moreInfo.value.value = authStore.user.moreInfo;\r\n        });\r\n\r\n        \r\n        if(authStore.user.birthdate) birthdate.value.value = authStore.user.birthdate;\r\n        if(authStore.user.interests) selectedHobbies.value.value = authStore.user.interests;\r\n        if(authStore.user.nickname) nickname.value.value = authStore.user.nickname;\r\n\r\n\r\n    })\r\n\r\n    function contactCountryChanged() {\r\n        const newCountry = contactCountry.value.value;\r\n        const countryQuery = countries.value.find(country => country.name === newCountry);\r\n        selectedContactCountryLanguages.value = countryQuery ? countryQuery.languages : [];\r\n        language.value.value = '';\r\n    }\r\n\r\n    function completeProfile() {\r\n\r\n        const db = getFirestore(firebaseApp);\r\n        const docRef = doc(db, \"users\", authStore.user.uid);\r\n        const userData = {\r\n            birthdate: birthdate.value.value,\r\n            contactCountry: contactCountry.value.value,\r\n            country: yourCountry.value.value,\r\n            email: authStore.user.email,\r\n            interests: selectedHobbies.value.value,\r\n            language: language.value.value,\r\n            moreInfo: moreInfo.value.value,\r\n            nickname: nickname.value.value\r\n        }\r\n        setDoc(docRef, userData);\r\n\r\n        authStore.setUser({'uid': authStore.user.uid, ...userData});\r\n        router.push('/home');\r\n    }\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}