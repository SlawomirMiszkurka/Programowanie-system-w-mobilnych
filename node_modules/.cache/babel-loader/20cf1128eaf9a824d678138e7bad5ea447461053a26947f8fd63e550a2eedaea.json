{"ast":null,"code":"export function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return \" test \";\n}","map":{"version":3,"names":[],"sources":["D:\\UserData\\Desktop\\UEK\\PSM\\KKDP\\psm-project\\src\\components\\MessagesListPage.vue"],"sourcesContent":["<template>\r\n    test\r\n</template>\r\n\r\n<script setup>\r\n    import { firebaseApp } from '@/firebase';\r\nimport { useAuthStore } from '@/stores/auth';\r\nimport { collection, doc, getDoc, getDocs, getFirestore, or, query, where } from 'firebase/firestore';\r\nimport { onMounted } from 'vue';\r\n\r\n    onMounted(() => {\r\n        const db = getFirestore(firebaseApp);\r\n        const messagesColRef = collection(db, \"messages\");\r\n        const auth = useAuthStore();\r\n\r\n        const q = query(messagesColRef, or(where('from', '==', auth.user.uid),\r\n        where('to', '==', auth.user.uid)\r\n        ))\r\n\r\n        let uniqueRecipents = [];\r\n\r\n        getDocs(q)\r\n        .then((snapshot) => {\r\n            snapshot.forEach((doc) => {\r\n                let data = doc.data();\r\n                console.log(data);\r\n                console.log(auth.user.uid);\r\n\r\n                if(data.from != auth.user.uid && !uniqueRecipents.includes(data.from)) {\r\n                    uniqueRecipents.push(data.from);\r\n                }\r\n\r\n                if(data.to != auth.user.uid && !uniqueRecipents.includes(data.to)) {\r\n                    uniqueRecipents.push(data.to);\r\n                }\r\n            })\r\n        })\r\n        console.log(uniqueRecipents);\r\n        let uniqueRecipentsData = [];\r\n\r\n        for(let recipent in uniqueRecipents) {\r\n            const recipentDoc = doc(db, \"users\", recipent);\r\n            getDoc(recipentDoc)\r\n            .then((snapshot) => {\r\n                if(snapshot.exists()) {\r\n                    uniqueRecipentsData.push({\r\n                        'uid': recipent,\r\n                        nickname: snapshot.data().nickname\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        console.log(uniqueRecipents);\r\n        console.log(uniqueRecipentsData);\r\n\r\n    });\r\n</script>"],"mappings":";SAAU,QAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}